{% extends "nav.html" %}
{% block title %}{{ campaign.title }} • Public{% endblock %}

{% block extra_head %}
<style>
/* ---- Tokens aligned with index ---- */
:root{
  --ink:#0f172a; --muted:#64748b; --line:#e5e7eb; --panel:#ffffff; --glass:rgba(255,255,255,.70);
}
@media (prefers-color-scheme: dark){
  :root{ --ink:#e5e7eb; --muted:#94a3b8; --line:#1f2937; --panel:#0b0f19; --glass:rgba(23,25,35,.65); }
}

/* ---- Hero (neutral + soft particles) ---- */
.page-hero{
  position:relative; border-radius:20px; padding:24px;
  background:var(--panel); border:1px solid var(--line);
  box-shadow:0 10px 28px rgba(0,0,0,.06); overflow:hidden;
}
.page-hero .bg-particles{ position:absolute; inset:0; pointer-events:none; }
.page-hero .bg-particles span{
  position:absolute; display:block; border-radius:50%; opacity:.7; filter:blur(6px);
  animation:float linear infinite;
}
.page-hero .bg-particles span:nth-child(1){ width:120px;height:120px;background:rgba(96,165,250,.16); top:8%; left:10%; animation-duration:18s; }
.page-hero .bg-particles span:nth-child(2){ width:160px;height:160px;background:rgba(167,139,250,.14); top:64%; left:75%; animation-duration:24s; animation-delay:-6s; }
.page-hero .bg-particles span:nth-child(3){ width:90px;height:90px;background:rgba(244,114,182,.12); top:22%; left:82%; animation-duration:20s; animation-delay:-3s; }
@keyframes float{ 0%{transform:translate(0,0) scale(1)} 50%{transform:translate(24px,-36px) scale(1.06)} 100%{transform:translate(0,0) scale(1)} }

.head .eyebrow{ font-size:.8rem; letter-spacing:.16em; text-transform:uppercase; color:var(--muted); }
.head .title{ margin:.2rem 0 .2rem; font-weight:800; line-height:1.15; color:var(--ink); }
.head .kicker{ color:var(--muted); }

/* ---- Glass wrapper per week ---- */
.glass{
  background:var(--glass); -webkit-backdrop-filter:blur(12px); backdrop-filter:blur(12px);
  border-radius:16px; border:1px solid rgba(255,255,255,.35);
  box-shadow:0 10px 24px rgba(0,0,0,.08);
}
@media (prefers-color-scheme: dark){ .glass{ border-color:rgba(255,255,255,.08); } }

/* ---- Section header for each week ---- */
.week-head{
  display:flex; align-items:center; justify-content:space-between; gap:12px;
  padding:10px 12px; border-bottom:1px solid var(--line);
}
.week-title{ margin:0; font-weight:800; font-size:1rem; color:var(--ink); }
.meta{ color:var(--muted); }

/* ---- Item card ---- */
.item-card{
  background:#fff; border:1px solid var(--line); border-radius:14px; padding:14px;
  transition:transform .18s ease, box-shadow .18s ease, border-color .18s ease;
}
.item-card:hover{ transform:translateY(-2px); box-shadow:0 16px 28px rgba(0,0,0,.08); }
@media (prefers-color-scheme: dark){
  .item-card{ background:#0f172a; border-color:#1f2937; }
}

/* ---- Type chip ---- */
.type-chip{
  display:inline-block; font-size:.75rem; font-weight:700; text-transform:uppercase; letter-spacing:.06em;
  border:1px solid var(--line); border-radius:999px; padding:.2rem .5rem; color:var(--muted); background:#fff;
}
@media (prefers-color-scheme: dark){
  .type-chip{ background:#0f172a; border-color:#1f2937; color:#cbd5e1; }
}
</style>
{% endblock %}

{% block content %}
<section class="container my-3">
  <div class="page-hero">
    <div class="bg-particles"><span></span><span></span><span></span></div>
    <div class="head position-relative">
      <div class="eyebrow">Public Campaign</div>
      <h2 class="title mb-1">{{ campaign.title }}</h2>
      <p class="kicker mb-0">
        Topic: <strong>{{ campaign.topic }}</strong> • Starts: {{ campaign.starts_on }} • Weeks: {{ campaign.weeks }}
      </p>
    </div>
  </div>
</section>

<section class="container my-3">
  {% for w, items in weeks.items() %}
  <div class="glass p-0 mb-3">
    <div class="week-head">
      <h3 class="week-title">Week {{ w }}</h3>
      <span class="meta">{{ items|length }} items</span>
    </div>
    <div class="p-3">
      <div class="row g-3">
        {% for it in items %}
        <div class="col-12 col-md-6">
          <div class="item-card h-100">
            <div class="d-flex justify-content-between align-items-start">
              <span class="type-chip">{{ it.content_type }}</span>
            </div>
            <div class="fw-semibold mt-2" style="color:var(--ink)">{{ it.title }}</div>
            <div class="mt-1 meta" style="white-space:pre-wrap">{{ it.body }}</div>

            {% if it.sources and it.sources|length %}
              <div class="mt-2 small meta">
                <div class="fw-semibold" style="color:var(--ink)">Resources</div>
                {% for u in it.sources %}
                  <div>• <a href="{{ u }}" target="_blank" rel="noreferrer">{{ u }}</a></div>
                {% endfor %}
              </div>
            {% endif %}
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
  {% endfor %}
</section>
{% endblock %}
